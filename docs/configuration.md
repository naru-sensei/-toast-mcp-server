# 設定ガイド

このドキュメントでは、Windows 10 トースト通知機能付き MCP サーバーの設定オプションについて説明します。

## 目次

1. [コマンドライン引数](#コマンドライン引数)
2. [環境変数](#環境変数)
3. [設定ファイル](#設定ファイル)
4. [ログ設定](#ログ設定)
5. [通知設定](#通知設定)
6. [ネットワーク設定](#ネットワーク設定)

## コマンドライン引数

サーバーは以下のコマンドライン引数をサポートしています：

| 引数 | 短縮形 | 説明 | デフォルト値 |
|------|--------|------|------------|
| `--host` | `-H` | リッスンするホスト | 127.0.0.1 |
| `--port` | `-P` | リッスンするポート | 8000 |
| `--log-level` | `-L` | ログレベル | info |
| `--config` | `-C` | 設定ファイルのパス | なし |
| `--log-file` | `-F` | ログファイルのパス | なし（標準出力） |
| `--debug` | `-D` | デバッグモードを有効にする | False |
| `--help` | `-h` | ヘルプメッセージを表示する | - |

例：

```bash
python mcp_server.py --host 0.0.0.0 --port 9000 --log-level debug --log-file server.log
```

## 環境変数

サーバーは以下の環境変数をサポートしています：

| 環境変数 | 説明 | デフォルト値 |
|----------|------|------------|
| `MCP_HOST` | リッスンするホスト | 127.0.0.1 |
| `MCP_PORT` | リッスンするポート | 8000 |
| `MCP_LOG_LEVEL` | ログレベル | info |
| `MCP_CONFIG_FILE` | 設定ファイルのパス | なし |
| `MCP_LOG_FILE` | ログファイルのパス | なし（標準出力） |
| `MCP_DEBUG` | デバッグモードを有効にする | False |

環境変数はコマンドライン引数よりも優先度が低くなります。つまり、コマンドライン引数と環境変数の両方が設定されている場合、コマンドライン引数が使用されます。

例：

```bash
export MCP_HOST=0.0.0.0
export MCP_PORT=9000
export MCP_LOG_LEVEL=debug
python mcp_server.py
```

## 設定ファイル

サーバーは JSON 形式の設定ファイルをサポートしています。設定ファイルのパスは `--config` コマンドライン引数または `MCP_CONFIG_FILE` 環境変数で指定できます。

設定ファイルの例：

```json
{
  "server": {
    "host": "0.0.0.0",
    "port": 9000
  },
  "logging": {
    "level": "debug",
    "file": "server.log"
  },
  "notification": {
    "default_duration": 5,
    "default_type": "info",
    "icon_path": "path/to/icon.ico"
  }
}
```

設定ファイルはコマンドライン引数と環境変数よりも優先度が低くなります。つまり、同じ設定がコマンドライン引数、環境変数、設定ファイルで指定されている場合、コマンドライン引数が使用されます。

## ログ設定

サーバーは Python の標準ロギングシステムを使用しています。ログレベルは以下のいずれかに設定できます：

- `debug`: デバッグ情報を含むすべてのメッセージ
- `info`: 情報メッセージ、警告、エラー（デフォルト）
- `warning`: 警告とエラーのみ
- `error`: エラーのみ
- `critical`: 重大なエラーのみ

ログは標準出力またはファイルに出力できます。ファイルに出力する場合は、`--log-file` コマンドライン引数または `MCP_LOG_FILE` 環境変数でファイルパスを指定します。

## 通知設定

通知の動作は以下の設定で制御できます：

| 設定 | 説明 | デフォルト値 |
|------|------|------------|
| `default_duration` | 通知の表示時間（秒） | 5 |
| `default_type` | デフォルトの通知タイプ | info |
| `icon_path` | カスタムアイコンのパス（Windows のみ） | なし |

これらの設定は設定ファイルの `notification` セクションで指定できます。

## ネットワーク設定

サーバーのネットワーク動作は以下の設定で制御できます：

| 設定 | 説明 | デフォルト値 |
|------|------|------------|
| `host` | リッスンするホスト | 127.0.0.1 |
| `port` | リッスンするポート | 8000 |
| `max_connections` | 最大同時接続数 | 10 |
| `timeout` | 接続タイムアウト（秒） | 60 |

これらの設定は設定ファイルの `server` セクションで指定できます。

### ホスト設定

`host` パラメータには以下の値を設定できます：

- `127.0.0.1` または `localhost`: ローカルマシンからの接続のみを許可します（デフォルト）
- `0.0.0.0`: すべてのネットワークインターフェースからの接続を許可します
- 特定の IP アドレス: 指定した IP アドレスからの接続のみを許可します

セキュリティ上の理由から、サーバーをインターネットに公開する場合は、適切な認証と暗号化を設定することを強く推奨します。
